(function(){function b(a){return b.enabled(a)?function(c){var d=new Date,e=d-(b[a]||d);b[a]=d,c=a+" "+c+" +"+b.humanize(e),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function c(b,d){var e=c.resolve(b),f=c.modules[e];if(!f)throw new Error('failed to require "'+b+'" from '+d);return f.exports||(f.exports={},f.call(f.exports,f,f.exports,c.relative(e),a)),f.exports}var a=this;b.names=[],b.skips=[],b.enable=function(a){localStorage.debug=a;var c=(a||"").split(/[\s,]+/),d=c.length;for(var e=0;e<d;e++)a=c[e].replace("*",".*?"),a[0]==="-"?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+a+"$"))},b.disable=function(){b.enable("")},b.humanize=function(a){var b=1e3,c=6e4,d=60*c;return a>=d?(a/d).toFixed(1)+"h":a>=c?(a/c).toFixed(1)+"m":a>=b?(a/b|0)+"s":a+"ms"},b.enabled=function(a){for(var c=0,d=b.skips.length;c<d;c++)if(b.skips[c].test(a))return!1;for(var c=0,d=b.names.length;c<d;c++)if(b.names[c].test(a))return!0;return!1},window.localStorage&&b.enable(localStorage.debug),c.modules={},c.resolve=function(a){var b=a,d=a+".js",e=a+"/index.js";return c.modules[d]&&d||c.modules[e]&&e||b},c.register=function(a,b){c.modules[a]=b},c.relative=function(a){return function(d){if("debug"==d)return b;if("."!=d.charAt(0))return c(d);var e=a.split("/"),f=d.split("/");e.pop();for(var g=0;g<f.length;g++){var h=f[g];".."==h?e.pop():"."!=h&&e.push(h)}return c(e.join("/"),a)}},c.register("channel.js",function(a,b,c,d){function j(a,b,c){this.opts=b.opts,this.io=b.io,this.url=b.url,this.ns=b.ns||"stream",this.name=a,this.watches={},this.actions=["join","leave","fetch","lock","unlock","complete","error"],this.events=["message","close","connect","connecting","connect_failed","reconnect","reconnecting","reconnect_failed","disconnect"],this.connect(c)}var e=c("./events").EventEmitter,f=c("debug")("bid.io-client:channel"),g=c("./parser"),h=g.encode,i=g.decode;a.exports=j,j.prototype.__proto__=e.prototype,j.prototype.connect=function(){this.socket=this.io.connect(this.url+"/"+this.name,this.opts);for(var a=0,b;b=this.events[a];a++)this.bind(b);return this},j.prototype.bind=function(a){var b=this;b.socket.on(a,function(){var c=Array.prototype.slice.call(arguments);b.emit.apply(b,[a].concat(c))})},j.prototype.fetch=function(a,b){this.send(g.FETCH,a,b)},j.prototype.open=function(a,b,c){return this.send(g.LOCK,a,b,c),this},j.prototype.cancel=function(a,b,c){return this.send(g.UNLOCK,a,b,c),this},j.prototype.complete=function(a,b,c){return this.send(g.COMPLETE,a,b,c),this},j.prototype.watch=function(a,b,c){"function"==typeof a?(c=a,b="*",a=null):~this.actions.indexOf(a)?(c=b,b=a,a=null):"function"==typeof b&&(c=b,b="*");var d=this,e=[].slice.apply(arguments),f=function(a){return b=b.toString(),a=a.toLowerCase(),~b.indexOf(a)};return d.watches[a]=function(d){var e=i(d),h=e.id,j=e.type,k=g.types[j],l=f(k);if(a&&h==a&&l)return c(e.data,k);if(a&&h==a&&f("*"))return c(e.data,k);if(a&&h!=a)return;if(!a&&l||f("*"))return c(e.data,k)},d.socket.on(this.ns,d.watches[a]),this},j.prototype.unwatch=function(a){var b=this.watches[a];return b&&(this.socket.removeListener(this.ns,b),delete this.watches[a],console.log("unwatching bid: ",a,"actions: ",actions)),this},j.prototype.send=function(a,b,c,d){"function"==typeof c&&(d=c,c=null);var e={owner:c},f=h({type:a,id:b,data:e});this.socket.emit(this.ns,f,function(a){var b=i(a);g.ERROR===b.type?d&&d(b.data):d&&d(null,b.data)})}}),c.register("events.js",function(a,b,c,d){function e(){}function f(a){return"[object Array]"===Object.prototype.toString.call(a)}b.EventEmitter=e,e.prototype.on=function(a,b){return this.$events||(this.$events={}),this.$events[a]?f(this.$events[a])?this.$events[a].push(b):this.$events[a]=[this.$events[a],b]:this.$events[a]=b,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(a,b){function d(){c.removeListener(a,d),b.apply(this,arguments)}var c=this;return d.listener=b,this.on(a,d),this},e.prototype.removeListener=function(a,b){if(this.$events&&this.$events[a]){var c=this.$events[a];if(f(c)){var d=-1;for(var e=0,g=c.length;e<g;e++)if(c[e]===b||c[e].listener&&c[e].listener===b){d=e;break}if(d<0)return this;c.splice(d,1),c.length||delete this.$events[a]}else(c===b||c.listener&&c.listener===b)&&delete this.$events[a]}return this},e.prototype.removeAllListeners=function(a){return a===undefined?(this.$events={},this):(this.$events&&this.$events[a]&&(this.$events[a]=null),this)},e.prototype.listeners=function(a){return this.$events||(this.$events={}),this.$events[a]||(this.$events[a]=[]),f(this.$events[a])||(this.$events[a]=[this.$events[a]]),this.$events[a]},e.prototype.emit=function(a){if(!this.$events)return!1;var b=this.$events[a];if(!b)return!1;var c=Array.prototype.slice.call(arguments,1);if("function"==typeof b)b.apply(this,c);else{if(!f(b))return!1;var d=b.slice();for(var e=0,g=d.length;e<g;e++)d[e].apply(this,c)}return!0}}),c.register("index.js",function(a,b,c,d){function h(a,b){return b=b||{},io="undefined"!=typeof eio?eio:io,new e(a,b)}var e=c("./manager"),f=c("./channel"),g=c("./parser");a.exports=b=h,b.protocol=g.protocol,b.Manager=e,b.Channel=f}),c.register("manager.js",function(a,b,c,d){function g(a,b){b=b||{},this.url=a,this.io=io,this.opts=b,this.chnls={},this.socket=io.connect(a,b)}var e=c("./channel"),f=c("debug")("bid.io-client:manager");if("undefined"==typeof eio&&"undefined"==typeof io)throw Error("Please include socket.io client.");a.exports=g,g.prototype.io=function(a){f("joining channel %s",a);var b=new e(a,this);return this.chnls[a]=b,this.chnls[a]},g.prototype.join=function(a){f("joining channel %s",a);var b=new e(a,this);return this.chnls[a]=b,this.chnls[a]},g.prototype.leave=function(a){var b=this.chnls[a];return b?(f("disconnecting from channel %s",a),b.disconnect(),delete this.chnls[a]):f("unable to find channel %s",a),this}}),c.register("parser.js",function(a,b,c,d){function f(a){return{type:b.ERROR,message:"parser error"}}var e=c("debug")("bid.io-parser");b.protocol=1,b.types=["JOIN","LEAVE","FETCH","LOCK","UNLOCK","COMPLETE","ERROR"],b.JOIN=0,b.LEAVE=1,b.FETCH=2,b.LOCK=3,b.UNLOCK=4,b.COMPLETE=5,b.ERROR=6,b.encode=function(a){var b="";return b+=a.type,null!=a.id&&(b+=a.id),null!=a.data&&(b+=JSON.stringify(a.data)),e("encoded %j as %s",a,b),b},b.decode=function(a){var c={},d=0,g=0;c.type=Number(a.charAt(0));if(null==b.types[c.type])return f();var h=a.charAt(d+1);if(""!=h&&Number(h)==h){c.id="";while(++d){var i=a.charAt(d);if(null==i||Number(i)!=i){--d;break}c.id+=a.charAt(d);if(d+1==a.length)break}}if(a.charAt(++d))try{c.data=JSON.parse(a.substr(d))}catch(j){return console.log(j),f(j)}return e("decoded %s as %j",a,c),c}});var d=c("index.js");"undefined"!=typeof module?module.exports=d:bio=d})();